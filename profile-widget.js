// Profile Widget System for Farm2Market\nclass ProfileWidget {\n    constructor() {\n        this.userProfile = null;\n        this.userRole = null;\n        this.init();\n    }\n\n    init() {\n        this.loadUserData();\n        this.updateNavigation();\n        this.setupEventListeners();\n    }\n\n    loadUserData() {\n        this.userRole = localStorage.getItem('userRole');\n        const profileData = localStorage.getItem('userProfile');\n        \n        if (profileData) {\n            try {\n                this.userProfile = JSON.parse(profileData);\n            } catch (error) {\n                console.error('Error parsing user profile:', error);\n                this.userProfile = null;\n            }\n        }\n    }\n\n    updateNavigation() {\n        const authButton = document.getElementById('authButton');\n        const authContent = document.getElementById('authContent');\n        \n        if (this.userRole && this.userProfile && authButton && authContent) {\n            // User is logged in\n            const userName = this.userProfile.name || this.userRole.charAt(0).toUpperCase() + this.userRole.slice(1);\n            const userInitial = userName.charAt(0).toUpperCase();\n            \n            authButton.innerHTML = `\n                <div style=\"display: flex; align-items: center; gap: 0.5rem;\">\n                    <div style=\"width: 32px; height: 32px; background: #4CAF50; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.9rem;\">\n                        ${userInitial}\n                    </div>\n                    <span>${userName}</span>\n                    <i class=\"fas fa-chevron-down\"></i>\n                </div>\n            `;\n            \n            authContent.innerHTML = `\n                <a href=\"profile.html\"><i class=\"fas fa-user\"></i> My Profile</a>\n                <a href=\"verification.html\"><i class=\"fas fa-shield-alt\"></i> Verification</a>\n                <a href=\"analytics.html\"><i class=\"fas fa-chart-bar\"></i> Analytics</a>\n                <div style=\"border-top: 1px solid #eee; margin: 0.5rem 0;\"></div>\n                <a href=\"#\" onclick=\"logout()\"><i class=\"fas fa-sign-out-alt\"></i> Logout</a>\n            `;\n        } else if (authButton && authContent) {\n            // User is not logged in\n            authButton.innerHTML = '<i class=\"fas fa-sign-in-alt\"></i> Login <i class=\"fas fa-chevron-down\"></i>';\n            authContent.innerHTML = `\n                <a href=\"login.html\"><i class=\"fas fa-sign-in-alt\"></i> Login</a>\n                <a href=\"register.html\"><i class=\"fas fa-user-plus\"></i> Register</a>\n            `;\n        }\n    }\n\n    setupEventListeners() {\n        // Listen for storage changes (when user logs in/out in another tab)\n        window.addEventListener('storage', (e) => {\n            if (e.key === 'userRole' || e.key === 'userProfile') {\n                this.loadUserData();\n                this.updateNavigation();\n            }\n        });\n    }\n\n    // Method to get user profile\n    getUserProfile() {\n        return this.userProfile;\n    }\n\n    // Method to get user role\n    getUserRole() {\n        return this.userRole;\n    }\n\n    // Method to check if user is logged in\n    isLoggedIn() {\n        return this.userRole !== null;\n    }\n\n    // Method to update profile\n    updateProfile(newProfileData) {\n        if (this.userProfile) {\n            this.userProfile = { ...this.userProfile, ...newProfileData };\n            localStorage.setItem('userProfile', JSON.stringify(this.userProfile));\n            this.updateNavigation();\n        }\n    }\n\n    // Method to logout\n    logout() {\n        localStorage.removeItem('userRole');\n        localStorage.removeItem('userProfile');\n        this.userRole = null;\n        this.userProfile = null;\n        this.updateNavigation();\n        \n        // Show notification\n        if (typeof showNotification === 'function') {\n            showNotification('Logged out successfully', 'info');\n        }\n        \n        // Redirect to home page\n        setTimeout(() => {\n            window.location.href = 'index.html';\n        }, 1000);\n    }\n\n    // Method to create profile summary widget\n    createProfileSummary(containerId) {\n        const container = document.getElementById(containerId);\n        if (!container || !this.userProfile) return;\n\n        const summaryHTML = `\n            <div class=\"profile-summary-widget\">\n                <div class=\"profile-header\">\n                    <div class=\"profile-avatar\">\n                        ${this.userProfile.name.charAt(0).toUpperCase()}\n                    </div>\n                    <div class=\"profile-info\">\n                        <h3>${this.userProfile.name}</h3>\n                        <p class=\"profile-role\">${this.userProfile.role.charAt(0).toUpperCase() + this.userProfile.role.slice(1)}</p>\n                        ${this.userProfile.rating ? `<div class=\"profile-rating\">⭐ ${this.userProfile.rating}</div>` : ''}\n                    </div>\n                </div>\n                <div class=\"profile-stats\">\n                    ${this.userProfile.totalTrades ? `<div class=\"stat\"><span class=\"stat-value\">${this.userProfile.totalTrades}</span><span class=\"stat-label\">Trades</span></div>` : ''}\n                    ${this.userProfile.totalRevenue ? `<div class=\"stat\"><span class=\"stat-value\">₹${(this.userProfile.totalRevenue / 100000).toFixed(1)}L</span><span class=\"stat-label\">Revenue</span></div>` : ''}\n                    ${this.userProfile.successRate ? `<div class=\"stat\"><span class=\"stat-value\">${this.userProfile.successRate}%</span><span class=\"stat-label\">Success</span></div>` : ''}\n                </div>\n            </div>\n        `;\n\n        container.innerHTML = summaryHTML;\n        this.addProfileSummaryStyles();\n    }\n\n    addProfileSummaryStyles() {\n        if (document.getElementById('profile-summary-styles')) return;\n\n        const styles = document.createElement('style');\n        styles.id = 'profile-summary-styles';\n        styles.textContent = `\n            .profile-summary-widget {\n                background: white;\n                border-radius: 12px;\n                padding: 1.5rem;\n                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);\n                border: 1px solid #e0e0e0;\n            }\n\n            .profile-header {\n                display: flex;\n                align-items: center;\n                gap: 1rem;\n                margin-bottom: 1rem;\n            }\n\n            .profile-avatar {\n                width: 60px;\n                height: 60px;\n                background: linear-gradient(135deg, #4CAF50, #2E7D32);\n                border-radius: 50%;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                color: white;\n                font-size: 1.5rem;\n                font-weight: bold;\n            }\n\n            .profile-info h3 {\n                margin: 0 0 0.25rem 0;\n                color: #2E7D32;\n                font-size: 1.2rem;\n            }\n\n            .profile-role {\n                margin: 0;\n                color: #666;\n                font-size: 0.9rem;\n                text-transform: capitalize;\n            }\n\n            .profile-rating {\n                margin-top: 0.25rem;\n                font-size: 0.9rem;\n                color: #FF9800;\n            }\n\n            .profile-stats {\n                display: flex;\n                gap: 1rem;\n                justify-content: space-around;\n                padding-top: 1rem;\n                border-top: 1px solid #f0f0f0;\n            }\n\n            .stat {\n                text-align: center;\n            }\n\n            .stat-value {\n                display: block;\n                font-size: 1.2rem;\n                font-weight: bold;\n                color: #2E7D32;\n            }\n\n            .stat-label {\n                display: block;\n                font-size: 0.8rem;\n                color: #666;\n                margin-top: 0.25rem;\n            }\n        `;\n\n        document.head.appendChild(styles);\n    }\n}\n\n// Initialize profile widget when DOM is loaded\ndocument.addEventListener('DOMContentLoaded', function() {\n    window.profileWidget = new ProfileWidget();\n});\n\n// Global logout function\nfunction logout() {\n    if (window.profileWidget) {\n        window.profileWidget.logout();\n    } else {\n        // Fallback logout\n        localStorage.removeItem('userRole');\n        localStorage.removeItem('userProfile');\n        window.location.href = 'index.html';\n    }\n}\n\n// Export for use in other files\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = ProfileWidget;\n} else {\n    window.ProfileWidget = ProfileWidget;\n}